pipeline {
	agent any
	
	stages {
		stage('Build') {
			steps {
				script {
                    bat 'msbuild WebApp.csproj /restore /p:Configuration=Release %MSBUILD_ARGS%'
                }
			}
		}
		stage('Publish') {
			steps {
				script {
                    bat 'dotnet publish -c Release -o ./publish'
                }
			}
		}
		stage('Deploy') {
			steps {
				echo 'Deploying...'
                bat 'scp.exe -r ./publish/* CICDTEST\nvanhecke@4.211.249.95:/inetpub/wwwroot'
			}
		}
	 }
}